# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ "Deploy error"

## ‚ö° –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

1. ‚úÖ –°–æ–∑–¥–∞–Ω `.dockerignore` - –∏—Å–∫–ª—é—á–∞–µ—Ç —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ —Ñ–∞–π–ª—ã –∏–∑ –æ–±—Ä–∞–∑–∞
2. ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω `Dockerfile` - —É–ª—É—á—à–µ–Ω–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Timeweb.Cloud
3. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω HEALTHCHECK –≤ Dockerfile
4. ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –∫–æ–¥–∏—Ä–æ–≤–∫–∞ UTF-8

### üöÄ –ß—Ç–æ –¥–µ–ª–∞—Ç—å —Å–µ–π—á–∞—Å:

#### –í–∞—Ä–∏–∞–Ω—Ç 1: –î–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ Git (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# 1. –î–æ–±–∞–≤—å—Ç–µ –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
git add .

# 2. –ö–æ–º–º–∏—Ç
git commit -m "Fix deploy error: add .dockerignore and optimize Dockerfile"

# 3. –ü—É—à
git push origin main
```

–ó–∞—Ç–µ–º –≤ Timeweb.Cloud:
- –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è/–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- –ù–∞–∂–º–∏—Ç–µ "Redeploy" –∏–ª–∏ "–ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å"
- –ü–æ–¥–æ–∂–¥–∏—Ç–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–±–æ—Ä–∫–∏

#### –í–∞—Ä–∏–∞–Ω—Ç 2: –õ–æ–∫–∞–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞ –∏ –ø—É—à

```bash
# 1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É back
cd back

# 2. –°–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑
docker build -t hayalkiz-bot .

# 3. –ï—Å–ª–∏ —Å–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞, –∑–∞–≥—Ä—É–∑–∏—Ç–µ –Ω–∞ Docker Hub
docker tag hayalkiz-bot YOUR_USERNAME/hayalkiz-bot:latest
docker push YOUR_USERNAME/hayalkiz-bot:latest
```

–ó–∞—Ç–µ–º –≤ Timeweb.Cloud —É–∫–∞–∂–∏—Ç–µ –æ–±—Ä–∞–∑: `YOUR_USERNAME/hayalkiz-bot:latest`

### ‚öôÔ∏è –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ! –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–í –ø–∞–Ω–µ–ª–∏ Timeweb.Cloud –¥–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–ë–ï–ó —Ñ–∞–π–ª–∞ keys.env):

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------------|----------|
| `TELEGRAM_BOT_TOKEN` | `YOUR_BOT_TOKEN_FROM_BOTFATHER` |
| `OPENAI_API_KEY` | `YOUR_OPENAI_API_KEY` |
| `WEBAPP_URL` | `https://your-webapp-url.com/` |
| `FLUX_API_KEY` | `YOUR_FLUX_API_KEY` |
| `FLUX_API_URL` | `https://api.bfl.ai/v1/flux-kontext-pro` |
| `DATABASE_PATH` | `data/app.db` |

### üìã –ß–∞—Å—Ç—ã–µ –ø—Ä–∏—á–∏–Ω—ã "Deploy error"

| –ü—Ä–æ–±–ª–µ–º–∞ | –†–µ—à–µ–Ω–∏–µ |
|----------|---------|
| **–§–∞–π–ª keys.env –≤ –æ–±—Ä–∞–∑–µ** | –¢–µ–ø–µ—Ä—å –∏—Å–∫–ª—é—á–µ–Ω —á–µ—Ä–µ–∑ `.dockerignore` ‚úÖ |
| **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å –∫ Dockerfile** | –£–±–µ–¥–∏—Ç–µ—Å—å: –µ—Å–ª–∏ –¥–µ–ø–ª–æ–∏—Ç–µ –∏–∑ –∫–æ—Ä–Ω—è - –ø—É—Ç—å `back/Dockerfile` |
| **–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–∞–º—è—Ç–∏** | –£–≤–µ–ª–∏—á—å—Ç–µ –ª–∏–º–∏—Ç –¥–æ 1GB –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ |
| **Timeout –ø—Ä–∏ —Å–±–æ—Ä–∫–µ** | Dockerfile –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Å–±–æ—Ä–∫–∏ ‚úÖ |
| **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã** | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –í–°–ï 6 –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤—ã—à–µ |

### üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ü–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ:

```bash
cd back

# –°–±–æ—Ä–∫–∞
docker build -t test-hayalkiz .

# –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ - —Å–º–æ—Ç—Ä–∏—Ç–µ, –Ω–∞ –∫–∞–∫–æ–º —à–∞–≥–µ
# –ï—Å–ª–∏ —É—Å–ø–µ—Ö - –∑–∞–ø—É—Å—Ç–∏—Ç–µ:
docker run -p 8000:8000 \
  -e TELEGRAM_BOT_TOKEN="YOUR_TOKEN" \
  -e OPENAI_API_KEY="YOUR_KEY" \
  -e WEBAPP_URL="https://giottobright-webapp-cd8e.twc1.net/" \
  test-hayalkiz

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:
curl http://localhost:8000/health
# –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å: {"status":"ok","service":"hayalkiz-bot"}
```

### ‚úÖ –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –ª–æ–≥–∏ –Ω–∞ Timeweb.Cloud**
2. –ù–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏:
   ```
   üöÄ –ó–ê–ü–£–°–ö –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø HAYALKIZ
   ‚úÖ HayalKiz Bot —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω
   ```
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–æ—Ç–∞** - –æ—Ç–ø—Ä–∞–≤—å—Ç–µ `/start`
4. **–í–µ—Ä–Ω–∏—Ç–µ—Å—å –∫ –ª–æ–≥–∞–º** - –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å—Ç—Ä–æ–∫–∞:
   ```
   üë§ /start –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ...
   ```

### ‚ùå –ï—Å–ª–∏ –≤—Å—ë –µ—â—ë –æ—à–∏–±–∫–∞

1. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–æ–ª–Ω—ã–µ –ª–æ–≥–∏ –æ—à–∏–±–∫–∏** –∏–∑ Timeweb.Cloud
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
   - –ü—É—Ç—å –∫ Dockerfile –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π?
   - –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã?
   - –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏ –ø–∞–º—è—Ç–∏ (min 512MB)?
   - –û—Ç–∫—Ä—ã—Ç –ª–∏ –ø–æ—Ä—Ç 8000?

3. **–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–æ–±—Ä–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ:**
   ```bash
   cd back
   docker build -t test .
   ```
   –ï—Å–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ –æ—à–∏–±–∫–∞ - –ø—Ä–æ–±–ª–µ–º–∞ –≤ –∫–æ–¥–µ/Dockerfile  
   –ï—Å–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ OK - –ø—Ä–æ–±–ª–µ–º–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Timeweb.Cloud

### üìä –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –≤ —Ñ–∞–π–ª–∞—Ö

1. **`.dockerignore`** (–Ω–æ–≤—ã–π —Ñ–∞–π–ª) - –∏—Å–∫–ª—é—á–∞–µ—Ç keys.env –∏–∑ –æ–±—Ä–∞–∑–∞
2. **`Dockerfile`** - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω, –¥–æ–±–∞–≤–ª–µ–Ω healthcheck
3. **`start.py`** - —É–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
4. **`app/main.py`** - –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### üéØ –ì–ª–∞–≤–Ω–æ–µ

**–°–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏ –ù–ï –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ Docker-–æ–±—Ä–∞–∑–µ!**  
–í—Å–µ –∫–ª—é—á–∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ –ø–∞–Ω–µ–ª–∏ Timeweb.Cloud.

---

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥–µ–ø–ª–æ–π —Å–µ–π—á–∞—Å –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏!
