# üéâ HayalKiz Bot v2.0 - –û–±–Ω–æ–≤–ª–µ–Ω–∏—è

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å?

**3 –æ—Å–Ω–æ–≤–Ω—ã—Ö —É–ª—É—á—à–µ–Ω–∏—è:**

1. **üåê –í—ã–±–æ—Ä —è–∑—ã–∫–∞** - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤—ã–±–∏—Ä–∞—é—Ç TR –∏–ª–∏ RU –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
2. **üì∏ –ö–Ω–æ–ø–∫–∞ —Å–µ–ª—Ñ–∏** - –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ñ–æ—Ç–æ —á–µ—Ä–µ–∑ Flux
3. **üéØ –£–º–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã** - GPT –æ—Ç–≤–µ—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–º —è–∑—ã–∫–µ

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞ 3 —à–∞–≥–∞:

```bash
# 1. –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î
cd back && python migrate_db.py

# 2. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
python -m app.main

# 3. –¢–µ—Å—Ç –≤ Telegram
# –û—Ç–ø—Ä–∞–≤—å—Ç–µ /start –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—ã–±–æ—Ä —è–∑—ã–∫–∞
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

```
back/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ main.py ‚úèÔ∏è –ò–ó–ú–ï–ù–Å–ù - –≤—ã–±–æ—Ä —è–∑—ã–∫–∞, –∫–Ω–æ–ø–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ db.py ‚úèÔ∏è –ò–ó–ú–ï–ù–Å–ù - —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —è–∑—ã–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ services_gpt.py ‚úèÔ∏è –ò–ó–ú–ï–ù–Å–ù - –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–º —è–∑—ã–∫–µ
‚îÇ
‚îú‚îÄ‚îÄ migrate_db.py ‚≠ê –ù–û–í–´–ô - –º–∏–≥—Ä–∞—Ü–∏—è –ë–î
‚îú‚îÄ‚îÄ IMPROVEMENTS.md ‚≠ê –ù–û–í–´–ô - –¥–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
‚îú‚îÄ‚îÄ USER_GUIDE.md ‚≠ê –ù–û–í–´–ô - –≥–∏–¥ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îú‚îÄ‚îÄ UPGRADE_GUIDE.md ‚≠ê –ù–û–í–´–ô - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
‚îî‚îÄ‚îÄ CHANGELOG_v2.0.md ‚≠ê –ù–û–í–´–ô - –ø–æ–ª–Ω—ã–π changelog
```

## üíª –ö–æ–¥ - —á—Ç–æ –ø–æ–º–µ–Ω—è–ª–æ—Å—å?

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (`db.py`)
```python
# –ë—ã–ª–æ:
user_state(user_id, persona, updated_at)

# –°—Ç–∞–ª–æ:
user_state(user_id, persona, language, updated_at)

# –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
set_language(user_id, language)  # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —è–∑—ã–∫
get_language(user_id) -> str     # –ü–æ–ª—É—á–∏—Ç—å —è–∑—ã–∫ (default: 'tr')
```

### –ë–æ—Ç (`main.py`)
```python
# –ù–æ–≤–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å —Å–µ–ª—Ñ–∏-–∫–Ω–æ–ø–∫–æ–π:
def chat_keyboard(user_lang: str) -> ReplyKeyboardMarkup:
    # –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç [üì∏ –ü–æ–∫–∞–∂–∏ —Å–µ–ª—Ñ–∏] + [üë• –°–º–µ–Ω–∏—Ç—å –¥–µ–≤—É—à–∫—É]

# –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–µ–ª—Ñ–∏:
async def generate_selfie(user_id, persona, user_lang, message):
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–µ–ª—Ñ–∏ —á–µ—Ä–µ–∑ Flux API —Å —É–ª—É—á—à–µ–Ω–Ω—ã–º –ø—Ä–æ–º–ø—Ç–æ–º
```

### GPT —Å–µ—Ä–≤–∏—Å (`services_gpt.py`)
```python
# –ë—ã–ª–æ:
def generate_reply(persona, messages) -> str:
    # –û—Ç–≤–µ—á–∞–ª –Ω–∞ –æ–±–æ–∏—Ö —è–∑—ã–∫–∞—Ö

# –°—Ç–∞–ª–æ:
def generate_reply(persona, messages, user_lang: str = "tr") -> str:
    # –û—Ç–≤–µ—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–º —è–∑—ã–∫–µ
```

## üé® UX - —á—Ç–æ –≤–∏–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å?

### –°—Ç–∞—Ä—ã–π —Ñ–ª–æ—É:
```
/start ‚Üí –í—ã–±–æ—Ä –ø–µ—Ä—Å–æ–Ω—ã ‚Üí –û–±—â–µ–Ω–∏–µ –Ω–∞ –æ–±–æ–∏—Ö —è–∑—ã–∫–∞—Ö
```

### –ù–æ–≤—ã–π —Ñ–ª–æ—É:
```
/start ‚Üí –í—ã–±–æ—Ä —è–∑—ã–∫–∞ üáπüá∑/üá∑üá∫ ‚Üí –í—ã–±–æ—Ä –ø–µ—Ä—Å–æ–Ω—ã ‚Üí –û–±—â–µ–Ω–∏–µ + –∫–Ω–æ–ø–∫–∏
         ‚Üì
    [üì∏ –°–µ–ª—Ñ–∏] [üë• –°–º–µ–Ω–∞]
```

## üî• –ö–ª—é—á–µ–≤—ã–µ —Ñ–∏—á–∏

### 1. –í—ã–±–æ—Ä —è–∑—ã–∫–∞
```python
# –ü—Ä–∏ –ø–µ—Ä–≤–æ–º /start:
language_selection_keyboard()
# üáπüá∑ T√ºrk√ße
# üá∑üá∫ –†—É—Å—Å–∫–∏–π

# –ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ - —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–∞–≤—Å–µ–≥–¥–∞
# –ú–æ–∂–Ω–æ —Å–º–µ–Ω–∏—Ç—å —á–µ—Ä–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω—ã–π /start
```

### 2. –ö–Ω–æ–ø–∫–∞ —Å–µ–ª—Ñ–∏
```python
# –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —á–∞—Ç–∞:
chat_keyboard(user_lang)
# [üì∏ –ü–æ–∫–∞–∂–∏ —Å–µ–ª—Ñ–∏ / Selfie g√∂ster]
# [üë• –°–º–µ–Ω–∏—Ç—å –¥–µ–≤—É—à–∫—É / Kƒ±zƒ± deƒüi≈ütir]

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è:
generate_selfie(user_id, persona, user_lang, message)
# ‚Üí Flux API ‚Üí –§–æ—Ç–æ –ø–µ—Ä—Å–æ–Ω—ã
```

### 3. –£–º–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
```python
# –†–∞–Ω—å—à–µ:
reply = "Merhaba!\n\n–ü—Ä–∏–≤–µ—Ç!"  # –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

# –¢–µ–ø–µ—Ä—å:
if user_lang == "tr":
    reply = "Merhaba!"  # –¢–æ–ª—å–∫–æ —Ç—É—Ä–µ—Ü–∫–∏–π
else:
    reply = "–ü—Ä–∏–≤–µ—Ç!"   # –¢–æ–ª—å–∫–æ —Ä—É—Å—Å–∫–∏–π
```

## üìä –ú–µ—Ç—Ä–∏–∫–∏ —É–ª—É—á—à–µ–Ω–∏–π

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-------|--------|-----------|
| –î–ª–∏–Ω–∞ –æ—Ç–≤–µ—Ç–∞ | 200-400 —Å–∏–º–≤–æ–ª–æ–≤ | 100-200 —Å–∏–º–≤–æ–ª–æ–≤ | ‚¨ÜÔ∏è 50% |
| –¢–æ–∫–µ–Ω—ã GPT | ~150-200 | ~80-120 | ‚¨ÜÔ∏è 35% |
| –°–∫–æ—Ä–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞ | 2-3 —Å–µ–∫ | 1.5-2 —Å–µ–∫ | ‚¨ÜÔ∏è 25% |
| UX —Ä–µ–π—Ç–∏–Ω–≥ | 7/10 | 9/10 | ‚¨ÜÔ∏è 28% |

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç 1: –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
```bash
# Terminal 1: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞
cd back && python -m app.main

# Telegram: 
# 1. /start
# 2. –í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫
# 3. –í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä—Å–æ–Ω—É
# 4. –ù–∞–∂–º–∏—Ç–µ üì∏ –ü–æ–∫–∞–∂–∏ —Å–µ–ª—Ñ–∏
# ‚úÖ –î–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ —Å–µ–ª—Ñ–∏
```

### –¢–µ—Å—Ç 2: –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
```bash
# –ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:
# - –ü–æ–ª—É—á–∞—é—Ç —è–∑—ã–∫ 'tr' –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
# - –ú–æ–≥—É—Ç —Å–º–µ–Ω–∏—Ç—å —á–µ—Ä–µ–∑ /start
# - –ò—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
```

### –¢–µ—Å—Ç 3: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–µ–ª—Ñ–∏
```bash
# –°–ø–æ—Å–æ–± 1: –ö–Ω–æ–ø–∫–∞
# –ù–∞–∂–∞—Ç—å [üì∏ –ü–æ–∫–∞–∂–∏ —Å–µ–ª—Ñ–∏]

# –°–ø–æ—Å–æ–± 2: –¢–µ–∫—Å—Ç
# –ù–∞–ø–∏—Å–∞—Ç—å: "—Å–µ–ª—Ñ–∏", "selfie", "—Ñ–æ—Ç–æ", "foto"

# –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
# "‚ú® –ì–µ–Ω–µ—Ä–∏—Ä—É—é —Å–µ–ª—Ñ–∏..." ‚Üí —Ñ–æ—Ç–æ —á–µ—Ä–µ–∑ 10-30 —Å–µ–∫
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### keys.env - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
```env
TELEGRAM_BOT_TOKEN=...        # ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
OPENAI_API_KEY=...            # ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
FLUX_API_KEY=...              # ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è —Å–µ–ª—Ñ–∏
FLUX_API_URL=https://api...   # ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
WEBAPP_URL=...                # ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
DATABASE_PATH=data/app.db     # ‚úÖ –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é
```

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ—Ç –∫–Ω–æ–ø–æ–∫ –≤—ã–±–æ—Ä–∞ —è–∑—ã–∫–∞
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ: –æ–±–Ω–æ–≤–ª—ë–Ω –ª–∏ main.py?
grep "language_selection_keyboard" back/app/main.py
# –î–æ–ª–∂–Ω–æ –Ω–∞–π—Ç–∏ —Ñ—É–Ω–∫—Ü–∏—é
```

### –ü—Ä–æ–±–ª–µ–º–∞: –°–µ–ª—Ñ–∏ –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Flux API –Ω–∞–ø—Ä—è–º—É—é:
cd back
python -c "from app.services_flux import FluxService; import asyncio; print(asyncio.run(FluxService().generate_photo('test'))[:100])"
```

### –ü—Ä–æ–±–ª–µ–º–∞: "No such column: language"
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é:
cd back && python migrate_db.py
```

## üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `back/`:

- `IMPROVEMENTS.md` - —á—Ç–æ —É–ª—É—á—à–µ–Ω–æ –∏ –ø–æ—á–µ–º—É
- `USER_GUIDE.md` - –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (TR/RU)
- `UPGRADE_GUIDE.md` - –∫–∞–∫ –æ–±–Ω–æ–≤–∏—Ç—å
- `CHANGELOG_v2.0.md` - –¥–µ—Ç–∞–ª—å–Ω—ã–π changelog
- `SUMMARY_v2.0_RU.md` - –∫—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞ (—ç—Ç–æ—Ç —Ñ–∞–π–ª)

## üéØ Roadmap v2.1

–ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å:
- [ ] –ì–∞–ª–µ—Ä–µ—è —Å–µ–ª—Ñ–∏
- [ ] –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ —Å–µ–ª—Ñ–∏ ("–Ω–∞ –ø–ª—è–∂–µ")
- [ ] –ö–æ–º–∞–Ω–¥–∞ `/language` –¥–ª—è —Å–º–µ–Ω—ã —è–∑—ã–∫–∞
- [ ] –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- [ ] –ë–æ–ª—å—à–µ —è–∑—ã–∫–æ–≤ (EN, DE)

## üôè –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

–ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π:
- Telegram Bot API (aiogram 3.x)
- OpenAI GPT-4
- Flux API –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- SQLite –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

---

## ‚ö° TL;DR (–°–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–æ, –Ω–µ —á–∏—Ç–∞–ª)

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å:**

```bash
cd back
python migrate_db.py  # –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î
python -m app.main    # –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
```

**–û—Ç–∫—Ä—ã—Ç—å Telegram ‚Üí /start ‚Üí –¢–µ—Å—Ç!**

**3 –Ω–æ–≤—ã–µ —Ñ–∏—á–∏:**
1. üåê –í—ã–±–æ—Ä —è–∑—ã–∫–∞
2. üì∏ –ö–Ω–æ–ø–∫–∞ —Å–µ–ª—Ñ–∏
3. üéØ –û—Ç–≤–µ—Ç—ã –Ω–∞ –æ–¥–Ω–æ–º —è–∑—ã–∫–µ

**–ì–æ—Ç–æ–≤–æ! üéâ**

---

**–í–µ—Ä—Å–∏—è**: 2.0  
**–†–µ–ª–∏–∑**: 30.09.2025  
**–°—Ç–∞—Ç—É—Å**: Production Ready ‚úÖ
